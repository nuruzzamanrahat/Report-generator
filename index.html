<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EBL Valuation Report Generator</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Print/Export styles */
        @media print {
            body { margin: 0; }
            .no-print { display: none !important; }
        }
        
        /* Word document styles */
        @page {
            size: A4;
            margin: 1in;
        }
        
        .word-content {
            font-family: 'Times New Roman', serif;
            font-size: 12pt;
            line-height: 1.5;
        }
        
        .word-table {
            border-collapse: collapse;
            width: 100%;
            margin: 10px 0;
        }
        
        .word-table td, .word-table th {
            border: 1px solid #000;
            padding: 5px;
            text-align: left;
        }
        
        .word-table th {
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Main Container -->
    <div class="container mx-auto px-4 py-8 max-w-7xl no-print">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">INSPECTION, SURVEY & VALUATION REPORT</h1>
            <p class="text-center text-gray-600">Eastern Bank PLC - Home Loan Template</p>
        </div>

        <!-- Form Sections -->
        <div class="space-y-6">
            <!-- Reference Details -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Reference Details</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Reference Account Name</label>
                        <input type="text" id="refAccountName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Reference No.</label>
                        <input type="text" id="refNumber" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">W/O Received Date</label>
                        <input type="date" id="woReceivedDate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Date of Inspection</label>
                        <input type="date" id="inspectionDate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
            </div>

            <!-- Surveyor Information -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Surveyor Information</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Surveyor Name</label>
                        <input type="text" id="surveyorName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Designation</label>
                        <input type="text" id="designation" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">NID Number</label>
                        <input type="text" id="nidNumber" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Contact Number</label>
                        <input type="text" id="contactNumber" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
            </div>

            <!-- Letter Details -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Letter Details</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">AMK Reference Number</label>
                        <input type="text" id="amkRef" placeholder="e.g., 001" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Report Date</label>
                        <input type="date" id="reportDate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Subject A/C Name</label>
                        <input type="text" id="subjectACName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
            </div>

            <!-- Valuation Summary -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Valuation Summary</h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="border border-gray-300 px-4 py-2 text-left">Description</th>
                                <th class="border border-gray-300 px-4 py-2">Land Area (Decimal)</th>
                                <th class="border border-gray-300 px-4 py-2">Rate per Decimal (BDT)</th>
                                <th class="border border-gray-300 px-4 py-2">Land Value (BDT)</th>
                                <th class="border border-gray-300 px-4 py-2">Building Value (BDT)</th>
                                <th class="border border-gray-300 px-4 py-2">Total Value (BDT)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2">Present Market Value</td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="pmvLandArea" class="w-full px-2 py-1 border-0 focus:ring-1 focus:ring-blue-500" onchange="calculateValues()"></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="pmvRate" class="w-full px-2 py-1 border-0 focus:ring-1 focus:ring-blue-500" onchange="calculateValues()"></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="pmvLandValue" class="w-full px-2 py-1 border-0 bg-gray-50" readonly></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="pmvBuildingValue" class="w-full px-2 py-1 border-0 focus:ring-1 focus:ring-blue-500" onchange="calculateValues()"></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="pmvTotalValue" class="w-full px-2 py-1 border-0 bg-gray-50" readonly></td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2">Forced Sale Value (20% less)</td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="fsvLandArea" class="w-full px-2 py-1 border-0 focus:ring-1 focus:ring-blue-500" onchange="calculateValues()"></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="fsvRate" class="w-full px-2 py-1 border-0 focus:ring-1 focus:ring-blue-500" onchange="calculateValues()"></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="fsvLandValue" class="w-full px-2 py-1 border-0 bg-gray-50" readonly></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="fsvBuildingValue" class="w-full px-2 py-1 border-0 focus:ring-1 focus:ring-blue-500" onchange="calculateValues()"></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="fsvTotalValue" class="w-full px-2 py-1 border-0 bg-gray-50" readonly></td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2">Mouza Value</td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="mvLandArea" class="w-full px-2 py-1 border-0 focus:ring-1 focus:ring-blue-500" onchange="calculateValues()"></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="mvRate" class="w-full px-2 py-1 border-0 focus:ring-1 focus:ring-blue-500" onchange="calculateValues()"></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="mvLandValue" class="w-full px-2 py-1 border-0 bg-gray-50" readonly></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="mvBuildingValue" class="w-full px-2 py-1 border-0 focus:ring-1 focus:ring-blue-500" onchange="calculateValues()"></td>
                                <td class="border border-gray-300 px-2 py-2"><input type="number" id="mvTotalValue" class="w-full px-2 py-1 border-0 bg-gray-50" readonly></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Buttons -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex justify-center space-x-4">
                    <button onclick="generateReport()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition duration-200 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Create Report
                    </button>
                    <button onclick="clearForm()" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-8 rounded-lg transition duration-200 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                        Clear Form
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Auto-calculate valuation values
        function calculateValues() {
            // Present Market Value
            const pmvLandArea = parseFloat(document.getElementById('pmvLandArea').value) || 0;
            const pmvRate = parseFloat(document.getElementById('pmvRate').value) || 0;
            const pmvBuildingValue = parseFloat(document.getElementById('pmvBuildingValue').value) || 0;
            document.getElementById('pmvLandValue').value = pmvLandArea * pmvRate;
            document.getElementById('pmvTotalValue').value = (pmvLandArea * pmvRate) + pmvBuildingValue;
            
            // Forced Sale Value
            const fsvLandArea = parseFloat(document.getElementById('fsvLandArea').value) || 0;
            const fsvRate = parseFloat(document.getElementById('fsvRate').value) || 0;
            const fsvBuildingValue = parseFloat(document.getElementById('fsvBuildingValue').value) || 0;
            document.getElementById('fsvLandValue').value = fsvLandArea * fsvRate;
            document.getElementById('fsvTotalValue').value = (fsvLandArea * fsvRate) + fsvBuildingValue;
            
            // Mouza Value
            const mvLandArea = parseFloat(document.getElementById('mvLandArea').value) || 0;
            const mvRate = parseFloat(document.getElementById('mvRate').value) || 0;
            const mvBuildingValue = parseFloat(document.getElementById('mvBuildingValue').value) || 0;
            document.getElementById('mvLandValue').value = mvLandArea * mvRate;
            document.getElementById('mvTotalValue').value = (mvLandArea * mvRate) + mvBuildingValue;
        }
        
        // Clear all form fields
        function clearForm() {
            if (confirm('Are you sure you want to clear all fields?')) {
                document.querySelectorAll('input, textarea, select').forEach(element => {
                    if (element.type !== 'button' && element.type !== 'submit') {
                        element.value = '';
                    }
                });
            }
        }
        
        // Generate Word document using HTML export
        function generateReport() {
            // Get form values
            const getValue = (id) => document.getElementById(id)?.value || '';
            
            // Create the Word document HTML content
            const htmlContent = `
            <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
            <head>
                <meta charset='utf-8'>
                <title>Inspection Survey Valuation Report</title>
                <style>
                    @page {
                        size: 8.5in 11.0in;
                        margin: 1.0in 1.0in 1.0in 1.0in;
                        mso-header-margin: .5in;
                        mso-footer-margin: .5in;
                        mso-paper-source: 0;
                    }
                    body {
                        font-family: 'Times New Roman', serif;
                        font-size: 12pt;
                        line-height: 1.5;
                        color: #000000;
                    }
                    h1 {
                        text-align: center;
                        font-size: 14pt;
                        font-weight: bold;
                        text-decoration: underline;
                        margin: 20px 0;
                    }
                    h2 {
                        font-size: 12pt;
                        font-weight: bold;
                        text-decoration: underline;
                        margin: 15px 0 10px 0;
                    }
                    table {
                        border-collapse: collapse;
                        width: 100%;
                        margin: 10px 0;
                    }
                    td, th {
                        border: 1px solid #000000;
                        padding: 5px;
                        text-align: left;
                        font-size: 11pt;
                    }
                    th {
                        font-weight: bold;
                        background-color: #f0f0f0;
                    }
                    .no-border {
                        border: none;
                    }
                    .center {
                        text-align: center;
                    }
                    .bold {
                        font-weight: bold;
                    }
                    .page-break {
                        page-break-after: always;
                    }
                    p {
                        margin: 10px 0;
                    }
                </style>
            </head>
            <body>
                <h1>INSPECTION, SURVEY & VALUATION REPORT</h1>
                
                <table>
                    <tr>
                        <td class="bold" width="30%">Reference Account Name</td>
                        <td width="5%">:</td>
                        <td>${getValue('refAccountName')}</td>
                    </tr>
                    <tr>
                        <td class="bold">Reference No.</td>
                        <td>:</td>
                        <td>${getValue('refNumber')}</td>
                    </tr>
                    <tr>
                        <td class="bold">W/O Received Date</td>
                        <td>:</td>
                        <td>${getValue('woReceivedDate')}</td>
                    </tr>
                    <tr>
                        <td class="bold">Date of Inspection</td>
                        <td>:</td>
                        <td>${getValue('inspectionDate')}</td>
                    </tr>
                </table>
                
                <br>
                
                <table>
                    <tr>
                        <td class="bold" width="30%">Surveyor Name</td>
                        <td width="5%">:</td>
                        <td>${getValue('surveyorName')}</td>
                    </tr>
                    <tr>
                        <td class="bold">Designation</td>
                        <td>:</td>
                        <td>${getValue('designation')}</td>
                    </tr>
                    <tr>
                        <td class="bold">NID Number</td>
                        <td>:</td>
                        <td>${getValue('nidNumber')}</td>
                    </tr>
                    <tr>
                        <td class="bold">Contact Number</td>
                        <td>:</td>
                        <td>${getValue('contactNumber')}</td>
                    </tr>
                </table>
                
                <br>
                
                <table>
                    <tr>
                        <td width="50%" style="vertical-align: top;">
                            <p class="bold">Submitted by:</p>
                            <p><strong>AMK Associates Limited</strong></p>
                            <p>68, Khilgaon Chowdhurypara (4th floor)</p>
                            <p>DIT Road, Rampura, Dhaka-1219</p>
                            <p>E-mail: amkassociatesbd@gmail.com</p>
                            <p>Website: www.amkassociatesltd.com</p>
                            <p>Contact: +88 01841-132714</p>
                        </td>
                        <td width="50%" style="vertical-align: top;">
                            <p class="bold">Submitted to:</p>
                            <p><strong>Mr. Mohammad Abu Kausar</strong></p>
                            <p>Head, Home Loan, Credit Administration</p>
                            <p>Eastern Bank PLC.</p>
                            <p>Head Office</p>
                            <p>Z N Tower, Bir Uttam Mir Shawkat Sarak</p>
                            <p>House # 02, Road # 08,</p>
                            <p>Gulshan-1, Dhaka-1212</p>
                            <p>Contact: +88 01830-302971</p>
                        </td>
                    </tr>
                </table>
                
                <br>
                
                <p>Ref.: AMK/EBPLC/2025/${getValue('amkRef')}</p>
                <p>Date: ${getValue('reportDate')}</p>
                
                <br>
                
                <p><strong>Mr. Mohammad Abu Kausar</strong></p>
                <p>Head, Home Loan, Credit Administration</p>
                <p>Eastern Bank PLC.</p>
                <p>Head Office, Z N Tower, Bir Uttam Mir Shawkat Sarak</p>
                <p>House # 02, Road # 08, Gulshan-1, Dhaka-1212</p>
                
                <br>
                
                <p><strong>Subject: Inspection, Survey & Valuation Report on Land with Building</strong></p>
                <p><strong>Ref. A/C Name: ${getValue('subjectACName')}</strong></p>
                
                <br>
                
                <p>Dear Sir,</p>
                <p>Greetings from AMK Associates Limited and Thank You very much for referring us!</p>
                <p>Pursuant to your communication, we, AMK Associates Limited ("AMK") has conducted the inspection, survey and valuation. Summary of the valuation is as below:</p>
                
                <br>
                
                <table>
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th>Total Land Area<br>(Decimal)</th>
                            <th>Present Rate per<br>Decimal (BDT)</th>
                            <th>Land Value<br>(BDT)</th>
                            <th>Building Value<br>(BDT)</th>
                            <th>Total Value<br>(BDT)</th>
                        </tr>
                        <tr>
                            <th></th>
                            <th style="font-style: italic;">a</th>
                            <th style="font-style: italic;">b</th>
                            <th style="font-style: italic;">c=a*b</th>
                            <th style="font-style: italic;">d</th>
                            <th style="font-style: italic;">e=c+d</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Present Market Value</td>
                            <td>${getValue('pmvLandArea')}</td>
                            <td>${getValue('pmvRate')}</td>
                            <td>${getValue('pmvLandValue')}</td>
                            <td>${getValue('pmvBuildingValue')}</td>
                            <td>${getValue('pmvTotalValue')}</td>
                        </tr>
                        <tr>
                            <td>Forced Sale Value<br>(20% less to Present Market Value)</td>
                            <td>${getValue('fsvLandArea')}</td>
                            <td>${getValue('fsvRate')}</td>
                            <td>${getValue('fsvLandValue')}</td>
                            <td>${getValue('fsvBuildingValue')}</td>
                            <td>${getValue('fsvTotalValue')}</td>
                        </tr>
                        <tr>
                            <td>Mouza Value</td>
                            <td>${getValue('mvLandArea')}</td>
                            <td>${getValue('mvRate')}</td>
                            <td>${getValue('mvLandValue')}</td>
                            <td>${getValue('mvBuildingValue')}</td>
                            <td>${getValue('mvTotalValue')}</td>
                        </tr>
                    </tbody>
                </table>
                
                <br>
                
                <p>The report has been prepared based on our physical inspection, verification, necessary documents as provided by concern office/individual, local market analysis and assessment to the best of our knowledge.</p>
                <p>Detail Report and necessary attachments are enclosed herewith for your record and perusal.</p>
                <p>For any query, please feel free to contact us.</p>
                <p>With best regards,</p>
                
                <br><br>
                
                <table style="border: none;">
                    <tr>
                        <td style="border: none; width: 40%;">
                            <p>Engr. Abdullah Al Rafi</p>
                            <p>Executive- Inspection, Survey & Valuation</p>
                        </td>
                        <td style="border: none; width: 20%;"></td>
                        <td style="border: none; width: 40%;">
                            <p>Md. Rashed Hossain</p>
                            <p>Manager & Unit-In-Charge: ISV</p>
                        </td>
                    </tr>
                </table>
                
                <br>
                
                <p><strong>Encl:</strong></p>
                <ol>
                    <li>Annexure-I: Photograph of Property</li>
                    <li>Annexure-II: Hand Sketch Map</li>
                    <li>Annexure-III: Mouza Map</li>
                    <li>Annexure-IV: Location on Google Map</li>
                    <li>Annexure-V: QR Code for video of the Property</li>
                    <li>Annexure-VI: QR Code for Map of the Property</li>
                    <li>Annexure-VII: SRO Mouza Value</li>
                    <li>Annexure-VIII: Status In Area Master Plan</li>
                </ol>
            </body>
            </html>`;
            
            // Create a Blob with the HTML content
            const blob = new Blob(['\ufeff', htmlContent], {
                type: 'application/msword'
            });
            
            // Create a download link
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            const today = new Date().toISOString().slice(0, 10);
            link.download = `EBL_Valuation_Report_${today}.doc`;
            
            // Trigger the download
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert('Report generated successfully! The file will open in Microsoft Word.');
        }
    </script>
</body>
</html>
